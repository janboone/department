#+TITLE: Health Care Expenditures
#+AUTHOR: Jan Boone, Minke Remmerswaal, and Bram Wouterse
#+REVEAL_ROOT: https://cdn.jsdelivr.net/npm/reveal.js
#+REVEAL_TRANS: cube
#+REVEAL_THEME: solarized
#+OPTIONS: toc:1 timestamp:nil num:nil
#+OPTIONS: reveal_width:1200 reveal_height:800
#+REVEAL_HLEVEL: 1
#+LANGUAGE:  en



* Introduction

** Motivation

+ worries about level/growth healthcare expenditures
+ demand side cost sharing contains expend.
+ currently 385 euros mandatory deductible in NL
+ trade off demand side cost-sharing:
  + lower expenditures
  + higher out-of-pocket for "sick" people
+ find /form/ of demand side cost sharing to alleviate this trade off?

** forms of cost sharing

+ popular with Dutch policy makers:
  + deductible
  + co-payment (say 25%)
  + shifted deductible ("donut")
+ CPB is supposed to "predict" healthcare expenditures under different schemes

** cost sharing

#+name: fig:shiftedD
#+caption: Out-of-pocket payments with a shifted deductible.
#+attr_latex: :width 250px
[[./shiftedD.png]]


** Research question

+ what are the effects of different cost-sharing /schemes/ on healthcare spending?
+ difficulty: after the reform, the Netherlands has only featured deductibles
+ so we can estimate $y_{it} = ... + \alpha D_t + \varepsilon_{it}$
+ but cannot determine effect of a 25% co-payment

** Method

+ use Bayesian estimation techniques to determine distributions of healtcare costs (per age-gender category)
+ determine (expected) out-of-pocket payment (OOP) for each category
+ determine effect of OOP on healthcare expenditures
+ then for each /scheme/ we determine OOP and then expenditures

** Why Bayesian?

+ distributions of healthcare spending are important for cost-sharing schemes
+ "standard" econometrics is based on sampling variation
  + but we have data on the whole population
+ we want policy recommendations that include uncertainty
+ Bayesian approach can easily work with distributions
+ it is fun!

** Policy recommendation
+ distribution of expenditures for given parameters
+ distribution of parameter values
#+attr_latex: :width 900px
#+caption: Trade offs increasing deductible
[[./deciles_deductible_male_female_Healthy.png]]

** Distributions 
#+attr_latex: :width 500px
#+caption: Expected (conditional) expenditures and prob. of expenditures
[[./ExpenditureOverAge.png]]

* Literature

** Modeling healthcare expenditures

+ Einav et al. (2013)
+ Hayen et al. (2019)
+ Remmerswaal et al. (2019)

* Model

** Simple model

+ one treatment per period: cost and value
+ two different deductibles
#+attr_latex: :width 250px
[[./deduct.png]]

** Total healthcare expenditure in a year
+ $H(z)$: distribution of healthcare expenditure in a year
  + where $z=x+y$
  + $x$: exogenous, not affected by cost-sharing, high-value care
     + if you break your leg, you get "plastered up"
  + $y$: endogenous, affected by cost-sharing
     + if you have a running injury, perhaps you skip the physiotherapy
 
** Idea of the model
+ "at the start of the year", person $i$ is offered one $y$ treatment with value $v_y$ and expected out-of-pocket $OOP$
+ $i$ accepts if $v_y$ exceeds expected $OOP$

+ $OOP$ depends on:
  + $f(x)$ ex-ante distribution of exogenous healthcare expenditure
  + $g(y)$ cost distribution of offered treatment $y$
  + cost-sharing scheme
+ for a deductible $D$, $OOP$ equals $\int_0^{+\infty} \int_0^{+\infty} (\min\{x+y,D\}-\min\{x,D\})f(x)g(y)dxdy$


* Data
 
** Dutch healthcare expenditure

+ expenditures per individual for 2008-2013
+ we use indiv.'s age and gender
+ later add income, indicators for health status
+ expenditures are for basic insurance under the deductible (e.g. not GP)
+ basic insurance is mandatory in the Netherlands
+ coverage is set by the government
+ we ignore people with voluntary deductible (for the moment)
+ deductible "kicks in" at 18

* Estimation

** Parametric specification
+ "everybody knows" that healthcare expenditures are log-normally distributed:
  + log transformation of positive healthcare costs are normally distributed
  + we model the propability of zero healthcare costs
  + benefits of log-normal distribution:
    + analytical expression for $OOP$ with deductible (estimation)
    + analytical expression for distribution of $x+y$

** Two distributions

#+name: fig:TwoDistributions
#+caption: Illustrative distributions for /positive/ healthcare costs (left in levels, right in logs)
[[./DistributionExpenditure.png]]

** Four components
+ define categories age by gender
  + each category /distribution/ (log) healthcare costs $z$
+ distribution is mixture of 4 components:
  + $x \sim N(\mu_x,\Sigma_x)$, given gender a Gaussian Process with age; year fixed effects
  + same for $y$
  + $\psi$ is probability treatment is offered ($x > 0$), GP with age
  + $\phi$ is same for $y > 0$

** OOP
+ people in each category know their $\psi,\phi$ and their distributions of $x,y$
+ calculate $OOP$ per age, gender, year with $x,y,\psi,D$
+ compute probability $F$ that $y$ is rejected ($v_y < OOP$)
  + $F(OOP) = 1-\zeta e^{-\nu*OOP}$

** Probabilities

+ calculate probability for each mixture component
| component | probability                 |
|-----------+-----------------------------|
| $x=y=0$   | $(1-\psi)(1-\phi + \phi F)$ |
| $x>0=y$   | $\psi*(1-\phi + \phi F)$    |
| $y>0=x$   | $(1-\psi)\phi(1-F)$         |
| $x,y>0$   | $\psi \phi (1-F)$           |

** Training vs validation data
+ we split the data in training, validation and test
+ we estimate on training
+ check fit with validation
+ look at test set once we are finished

** Technique
+ specify priors for parameters:
  + 5,000,000 observations per year
  + on average 65,000 observations per category per year
+ estimation with variational inference (ADVI, Auto-diff Variational Inference) and minibatches
  + Markov Chain Monte Carlo methods (Metropolis, NUTS etc.) do not scale well
+ python and pymc3 fun to work with
  + parameter $\phi$ has age fixed effects: ~Ï•[age]~

** Posterior
+ for each age-gender category, we draw 10,000 samples of the model parameters
+ for each sample we draw one $x,y$ and $z$
+ that is, we draw outcomes (not averages or expectations)
+ use the whole posterior distribution, not only the mode

** More formally
+ parameters $\theta$
+ data $y$
+ posterior:
\begin{equation}
Pr(\theta|y) = \frac{Pr(y|\theta)Pr(\theta)}{Pr(y)} = \frac{Pr(y|\theta)Pr(\theta)}{\int Pr(y|\theta)Pr(\theta)d\theta }
\end{equation}
+ we simulate this posterior ("samples")
+ for each sample, we generate an outcome (i.e. expenditure level)

* Fit

** How to measure fit

+ not obvious how to measure the fit of the model
+ we can compare: 
  + average expenditure per age-gender category (fit vs validation data) 
  + expenditure distributions per age-gender categories
  + predicted vs realized (validation) zero-expenditures per category

** Fit on average costs by age, year and sex

#+REVEAL_HTML: <iframe width="840" height="400" src="./fit_across_ages_logs.html" frameborder="0" allowfullscreen></iframe>
Left panel: women, right panel: men

** Expenditure distributions

#+name: fig:predictedvsValidationDistributions
#+caption: Average predicted vs average validation male log healthcare expenditures
#+attr_latex: :width 500px 
[[./PredictedvsValidationDistributions_healthy_Male.png]]

** Probability positive expenditures

#+name: fig:predictedposexpend
#+caption: Predicted and realized probabilities of positive expenditures for men across age and years.
#+attr_latex: :width 500px 
[[./PredictedPositiveExpenditureAcrossAge_healthy_Male.png]]


* Simulations

** Samples

+ we use $F(OOP) = 1-\zeta e^{-\nu OOP}$
+ is the estimate for $\nu$ "significant"?

#+name: fig:nu_women
#+caption: Posterior distribution of $\nu$ for women
#+attr_latex: :width 250px 
[[./Posterior_nu_y_healthy_Female.png]]

** Probability of rejecting
???continue here???
#+attr_latex: :width 500px
[[./ProbReject.png]]

** Deductible (women)

#+attr_latex: :width 500px
[[./deductibles.png]]

** Comparing different schemes

#+attr_latex: :width 500px
[[./example.png]]


* Conclusion

** Summary

+ in order to determine healthcare expenditures under different cost sharing schemes:
  + we estimated the distributions of healthcare expenditures
  + split expenditures up in exogenous and endogenous expenditures
  + determined expected OOP for endogenous expenditures under different schemes
  + estimate the value distribution of these endog. expenditures
  + the higher OOP, the more likely an (endogenous) treatment is rejected
  + allows us to simulate effects of different /schemes/

